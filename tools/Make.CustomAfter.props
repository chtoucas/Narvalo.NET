<?xml version="1.0" encoding="utf-8" ?>
<Project ToolsVersion="12.0"
         InitialTargets="_CheckCustomAfterProps"
         xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!-- 
    This file is injected at the end of Narvalo.Common.props by the entry project (e.g. Narvalo.proj).
  -->

  <!-- Overrides for properties defined in Narvalo.Common.props. -->
  <PropertyGroup>
    <!-- Treat all warnings as errors. -->
    <CodeAnalysisTreatWarningsAsErrors>true</CodeAnalysisTreatWarningsAsErrors>
    <CodeContractsFailBuildOnWarnings>true</CodeContractsFailBuildOnWarnings>
    <SourceAnalysisTreatErrorsAsWarnings>true</SourceAnalysisTreatErrorsAsWarnings>

    <!-- Reports are saved in a custom location. -->
    <CodeAnalysisLogFile>$(WorkReportsDir)$(AssemblyName).FxCop.xml</CodeAnalysisLogFile>
    <SourceAnalysisOutputFile>$(WorkReportsDir)$(AssemblyName).StyleCop.xml</SourceAnalysisOutputFile>

    <!-- We don't want the Code Analysis "succeed" file to be written to 
         the custom location but it does not seem to be understood by MSBuild. 
         As a workaround, we simply disable the creation of the success file. -->
    <!--<CodeAnalysisSucceededFile>$(OutDir)$(AssemblyName).FxCop.Succeed</CodeAnalysisSucceededFile>-->
    <CodeAnalysisGenerateSuccessFile>false</CodeAnalysisGenerateSuccessFile>

    <!-- Code Contracts background checking is not available in terminal. -->
    <CodeContractsRunInBackground>False</CodeContractsRunInBackground>
  </PropertyGroup>

  <Target Name="_CheckCustomAfterProps">
    <Error Text="You MUST define the 'WorkReportsDir' property before importing Make.CustomAfter.props. This should have been done by Make.Common.props imported by the entry project (e.g. Narvalo.proj)."
           ContinueOnError="false"
           Condition=" '$(WorkReportsDir)' == ''" />
  </Target>
</Project>