<?xml version="1.0" encoding="utf-8" ?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <ItemGroup>
    <!-- NB: The StyleCop package does not include StyleCop.CSharp.Rules.dll
      and the MSBuild package does some ugly stuff on your project file. -->
    <_StyleCopAssemblyFile Include="$(MSBuildThisFileDirectory)..\packages\StyleCop.*\lib\*\StyleCop.dll" />
  </ItemGroup>

  <UsingTask TaskName="StyleCopTask" AssemblyFile="@(_StyleCopAssemblyFile)" />

  <Import Project=".\StyleCop.targets" />

  <PropertyGroup>
    <SolutionDir Condition="$(SolutionDir) == '' Or $(SolutionDir) == '*Undefined*'">$(MSBuildThisFileDirectory)..\</SolutionDir>

    <StyleCopEnabled Condition="'$(Configuration)' == 'Debug'">false</StyleCopEnabled>
    <StyleCopEnabled Condition="'$(Configuration)' == 'Release'">true</StyleCopEnabled>
  </PropertyGroup>

  <PropertyGroup Condition="'$(ReportsDir)' != ''">
    <SourceAnalysisOutputFile>$(ReportsDir)$(AssemblyName).StyleCopViolations.xml</SourceAnalysisOutputFile>
    <CodeAnalysisLogFile>$(ReportsDir)$(AssemblyName).CodeAnalysisLog.xml</CodeAnalysisLogFile>
  </PropertyGroup>

  <Target Name="BeforeStyleCop"
          BeforeTargets="StyleCop"
          Condition="'$(StyleCopEnabled)' == 'true'">
    <Message Text="Running StyleCop Analysis on $(ProjectName)..." Importance="High" />
  </Target>

  <Target Name="AfterStyleCop"
          AfterTargets="StyleCop"
          Condition="'$(StyleCopEnabled)' == 'true'">
    <Message Text="Completed StyleCop Analysis on $(ProjectName)" Importance="High" />
  </Target>
</Project>